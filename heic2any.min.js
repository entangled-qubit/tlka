/**
 * heic2any v0.0.4
 * https://github.com/alexcorvi/heic2any
 * 
 * Copyright (c) 2018 Alex Corvi
 * Licensed under the MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.heic2any=t()}(this,function(){"use strict";var e=function(e,t,n){return new Promise(function(r,o){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(){if(200!==i.status)return void o(new Error("Failed to fetch HEIC file"));var e=new FileReader;e.onload=function(){var e=new Uint8Array(e.result),i=function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}(e),a=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charCodeAt(r));return new Uint8Array(n)}(i);t(a).then(function(e){r(e)},function(e){o(e)})},e.onerror=function(){o(new Error("Failed to read HEIC file"))},e.readAsArrayBuffer(i.response)},i.onerror=function(){o(new Error("Failed to fetch HEIC file"))},i.send()})},t=function(e){return new Promise(function(t,n){var r=document.createElement("canvas"),o=r.getContext("2d");if(!o)throw new Error("Canvas context is not supported");var i=new Image;i.onload=function(){r.width=i.width,r.height=i.height,o.drawImage(i,0,0);var e=r.toDataURL("image/jpeg",.92);t(e)},i.onerror=function(){n(new Error("Failed to load HEIC image"))},i.src=URL.createObjectURL(new Blob([e],{type:"image/heic"}))})};return function(n,r){return void 0===r&&(r="image/jpeg"),e(n,function(e){return t(e).then(function(e){return fetch(e).then(function(e){return e.blob()})})})}});